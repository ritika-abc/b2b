$(document).ready(function(){$(".ip_login").on("click",function(e){$('#post_req_popup_ei').html('');if(!$.trim($('#login_popup_container').html())){url=$("#base_url").val()+"/login_modal.php";$.post(url,function(data,status){if(status=='success'){$("#login_popup_container").html(data);$("#login_popup_container").show();$("#login_username").val("");$("#password").val("");if($('#popup_login').length){var popup_login_val=$('#popup_login').val();$('#popup_login').focus().val('').val(popup_login_val)}
if($('#cr_purl').val()){$('#ref_redirect_url').val($('#cr_purl').val());if($('#lgn_username').val()){$('#popup_login').val($('#lgn_username').val())}}}else{alert(data)}})}else{$("#login_popup_container").show();$("#login_username").val("");$("#password").val("");if($('#popup_login').length){var popup_login_val=$('#popup_login').val();$('#popup_login').focus().val('').val(popup_login_val)}}});$(document).on("click",".login_change_link #login_change_link, #change_em_otp",function(e){if($('#password').length>0){$('#loginPassword').find("#password").remove()}});$(document).on("click","#close_s",function(e){$("#login_popup_container").hide()});$(document).on("keypress",".otp-code23",function(e){if(this.value.length>0){$(this).val(event.key);e.preventDefault()}});$(document).on("keyup",".otp-code",function(e){$('#otp_send_txt').hide();if((e.which==8||e.which==46)&&$(this).val()==''){$('.request_otp_error').hide()}
if(/\D/g.test(this.value)){this.value=this.value.replace(/\D/g,'')}
if($(this).val().length>0){$(this).next('.otp-code').focus()}
disabled_otp_verify_btn_func()});$(document).on("keydown",".otp-code",function(e){if((e.which==8||e.which==46)&&$(this).val()==''){$(this).prev('input.otp-code').val('').focus()}});$(document).on('keyup',".common-txt-cls",function(){$(this).parent().parent().removeClass('invalid');$(this).parent().removeClass('invalid')});$(document).on("keypress","input.otp-code-last",function(e){var inputs=document.getElementsByClassName('otp-code'),v_code=[].map.call(inputs,function(input){return input.value}).join('');if(e.which==13&&v_code&&v_code.length==4){$("#otp-verify-nxt-btn").click()}});$(document).on('keyup',"#popup_login",function(){var len=$("#popup_login").val().trim().length;var uname=$("#popup_login").val().trim();var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];var atpos=uname.indexOf("@");var regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;var non_zero_exp=/^[5-9][0-9]*$/;if(len==0){$("#popup_login").parent().parent().removeClass('invalid')}
if(len>=2){if(atpos!=-1&&isd_code!=91){var mail_format=regex.test(uname);if(!mail_format){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile .err_msg").html("Enter valid email to login.");return!1}else{$("#popup_login").parent().parent().removeClass('invalid');$("#login_type").val('email')}}else{if(isd_code==91&&isNaN(uname)==!1){var num_valid_format=non_zero_exp.test(uname);if(!num_valid_format){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile .err_msg").html("Invalid Mobile Number");return!1}else if(len<10||len>10){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile .err_msg").html("Mobile number should be 10 digits.");return!1}else{$("#popup_login").parent().parent().removeClass('invalid');$("#login_type").val('mobile')}}else if(isd_code!=91){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile .err_msg").html("Enter valid email to login.");return!1}}}})});function check_login_type(uname){var login_type=$("#login_type").val();var str=[];if($('#login_country_code').length){var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^")}
country_code=str[0];isd_code=str[1];if(login_type==''&&uname!=''){var len=$("#popup_login").val().length;var atpos=uname.indexOf("@");var regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;$("#login_type").val('');if(len>=2){if(atpos!=-1&&isd_code!=91){var mail_format=regex.test(uname);if(!mail_format){$("#popup_login").parent().parent().addClass('invalid');$("#popup_login").focus();$("#loginWMobile .err_msg").html("Enter valid email to login.");return!1}else{$("#loginWMobile .err_msg").html("");$("#popup_login").parent().parent().removeClass('invalid');$("#login_type").val('email')}}else{if(isd_code==91&&isNaN(uname)==!1){if(len<10||len>10){$("#popup_login").parent().parent().addClass('invalid');$("#popup_login").focus();$("#loginWMobile .err_msg").html("Mobile number should be 10 digits.");return!1}else{$("#loginWMobile .err_msg").html("");$("#popup_login").parent().parent().removeClass('invalid');$("#login_type").val('mobile')}}else if(isd_code!=91){$("#popup_login").parent().parent().addClass('invalid');$("#popup_login").focus();$("#loginWMobile .err_msg").html("Enter valid email to login.");return!1}}}}else if((login_type!=''&&uname==''&&isd_code==91)||(login_type==''&&uname==''&&isd_code==91)){$("#popup_login").parent().parent().addClass('invalid');$("#popup_login").focus();$("#loginWMobile .err_msg").html("Enter valid mobile number to login.");return!1}else if((login_type!=''&&uname==''&&isd_code!=91)||(login_type==''&&uname==''&&isd_code!=91)){$("#popup_login").parent().parent().addClass('invalid');$("#popup_login").focus();$("#loginWMobile .err_msg").html("Enter valid email to login.");return!1}
return login_type}
function validate_user(uname2){var login_type;var uname=uname2.trim();login_type=check_login_type(uname);$("#member_type").val('');login_country_code=$('#login_country_code').val();var mem_baseurl=$("#mem_baseurl").val();var non_zero_exp=/^[5-9][0-9]*$/;if(login_type=='mobile'){var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];if(isd_code==91&&isNaN(uname)==!1){var num_valid_format=non_zero_exp.test(uname);if(!num_valid_format){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile .err_msg").html("Invalid Mobile Number");return!1}else if(uname.length<10||uname.length>10){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile .err_msg").html("Mobile number should be 10 digits.");return!1}else{$("#popup_login").parent().parent().removeClass('invalid')}}
url=$("#base_url").val()+"/login_ajax.php";$('#mobile_cont_code').val(country_code+'^'+isd_code);$.ajax({type:"POST",url:url,async:!1,data:{id:"check_mobile_in_db",isd_code:isd_code,mobile:uname},success:function(data,status){console.log(data+" "+status);if(status=='success'){console.log('check_mobile_in_db-success');parse_data=$.parseJSON(data);var myJSON1=JSON.stringify(data);var myJSON2=JSON.stringify(parse_data);console.log($.trim(parse_data.mobile_exists));if($.trim(parse_data.mobile_exists)=='N'){console.log('check_mobile_in_db-noexists');if($.trim(parse_data.auth_access)=='Y'){$("#loginWMobile .err_msg").html("Unauthorised login access !!!")}else{$("#loginWMobile .err_msg").html("SORRY!! We could not find any account registered with this Mobile. Check the entered Mobile OR <a href='"+$("#base_url").val()+"/register-business-online?joinfree=signinpopupjoinnow&new_nm="+uname+"&new_cc="+$('#login_country_code').val()+"'>Register Now</a>.")}
$("#popup_login").parent().parent().addClass('invalid');return!1}else if($.trim(parse_data.mobile_exists)=='Y'){console.log('check_mobile_in_db-yesexists');$("#login_type").val('mobile');$("#username_exists").val("Y");$("#member_type").val(parse_data.member_type);$("#login_username").val(uname);$("#popup_login").parent().parent().removeClass('invalid');return!0}}else{alert(data);return!1}}})}else if(login_type=='email'){var regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;var mail_format=regex.test(uname);if(!mail_format){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile .err_msg").html("Enter valid email to login.");return!1}else{$("#popup_login").parent().parent().removeClass('invalid')}
url=$("#base_url").val()+"/login_ajax.php";$.ajax({type:"POST",url:url,async:!1,data:{id:"check_email_in_db",username:uname},success:function(data,status){if(status=='success'){parse_data=$.parseJSON(data);if($.trim(parse_data.username_exists)=='N'){$("#loginWMobile .err_msg").html("SORRY!! We could not find any account registered with this Email. Check the entered Email OR <a href='"+$("#base_url").val()+"/register-business-online?joinfree=signinpopupjoinnow&new_em="+uname+"&new_cc="+$('#login_country_code').val()+"' class='track_scr' data-uname='' data-title='Register Now'>Register Now</a>.");$("#popup_login").parent().parent().addClass('invalid');return!1}else if($.trim(parse_data.username_exists)=='Y'){$("#login_type").val('email');$("#username_exists").val("Y");$("#member_type").val(parse_data.member_type);$("#login_username").val(uname);$("#popup_login").parent().parent().removeClass('invalid');return!0}}else{alert(data);return!1}}})}}
function request_forgot_em_otp(){if($("input:radio[name='forget_mob_numbers']").is(":checked")){if($("input[name='forget_mob_numbers']:checked").val()==0){var forget_your_mob_email=$("#forget_your_mob_email").val().trim();if($.trim($("#username_exists").val())=='Y'){$.ajax({type:"POST",url:$("#base_url").val()+"/login_ajax.php",async:!1,data:{id:"forgot_your_mob_step_none",username:forget_your_mob_email},success:function(data,status){if(status=='success'){if(data){var gt_data=$.trim(data);var gt_data_arr=gt_data.split('^^');var gt_data_first=gt_data_arr[0];var gt_data_second=gt_data_arr[1];if(gt_data_first==3&&gt_data_second.length==0){$('#forgotID2').hide();$('#login_lk_send_email').html(forget_your_mob_email);$('#forgotID-thanks').show();$('.comm_fmcls_hide').hide()}else if(gt_data_first==1&&gt_data_second.length==0){$('#forgotID2').hide();$('#forgot').show();$("#forget_your_mob_email").focus();$("#forget_your_mob_email").parent().addClass('invalid');$("#forgotID .err_msg").html("Invalid Email Id !! !!!!!!!!! ");return!1}}else{$('#forgotID2').hide();$('#forgot').show();$("#forget_your_mob_email").focus();$("#forget_your_mob_email").parent().addClass('invalid');$("#forgotID .err_msg").html("Invalid Email Id !! !!!!!!!!! ");return!1}}else{alert(data);return!1}}})}}else{$("#login_type").val('mobile');$("#popup_login").val($("input[name='forget_mob_numbers']:checked").val());$("#login_username").val($("input[name='forget_mob_numbers']:checked").val());$("#member_type").val($("input[name='forget_mob_numbers']:checked").attr('data-mt'));$('#login_country_code').val('IN^91');$('#mobile_cont_code').val('IN^91');request_otp('forget_your_mobile')}}else{alert('Please Checked Mobile Number First');return!1}}
function request_otp(mode=''){var logint;var mobile_login;var email_login;logint=$("#login_type").val();mobile_login=$("#popup_login").val().trim();email_login=$("#popup_login").val().trim();var member_type=$("#member_type").val();var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];if(member_type==''){validate_user($("#popup_login").val().trim());member_type=$("#member_type").val()}
if(logint=='email'&&email_login!=''&&member_type!=''&&country_code!='IN'){$.when(check_wl_ip_login(email_login,logint)).done(function(){ip_login=$("#check_wl_ip_login").val();if(ip_login==1){alert('Unauthorised login access');return!1}
send_otp_on_email(mode)})}else if(logint=='mobile'&&mobile_login!=''&&member_type!=''&&country_code=='IN'){$.when(check_wl_ip_login(mobile_login,logint)).done(function(){ip_login=$("#check_wl_ip_login").val();if(ip_login==1){alert('Unauthorised login access');return!1}
send_otp_on_mobile(mode)})}else{$("#forgot_email").val('');$("#your_mobile").val('');if(logint=='mobile'){validate_user(mobile_login)}else if(logint=='email'){validate_user(email_login)}
return!1}}
function send_otp_on_call(mode=''){var mobile=$("#popup_login").val();$("#otp_verified").val("");$("#sms_code").val("");var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];$(".otp-code").val("");$(".request_otp_error").hide();url=$("#base_url").val()+"/login_ajax.php";$.post(url,{id:"remind",remind_by:"otp_on_call",username:mobile,country_code:isd_code},function(data,status){if(status=='success'){var dta=$.trim(data);var ar=dta.split('^^');dta=ar[0];var code=ar[1];if(dta=='OTP sent successfully'){if(document.domain.indexOf('exportersindia.com')==-1){alert(code)}
if(mode&&mode=='forget_your_mobile'){$('#forgotID2').hide();$('#change_em_otp').hide()}else{$("#loginPassword").hide()}
$('.request_otp_text').html(' +91-'+mobile);$("#loginWOTP").show();$("#change_function_name").attr("onclick","send_otp_on_mobile();otpTimer();$('#re_send_otp').hide();$('#otp_time').show();");if(mode&&mode=='forget'){$("#otp-verify-nxt-btn").attr("onclick","request_otp_verify('forget');")}
$(".otp-code:first").focus();disabled_otp_verify_btn_func()}else{alert(data)}}else{alert(data);return!1}})}
function send_otp_on_mobile(mode=''){var mobile=$("#popup_login").val();$("#otp_verified").val("");$("#sms_code").val("");var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];$(".otp-code").val("");$(".request_otp_error").hide();url=$("#base_url").val()+"/login_ajax.php";$.post(url,{id:"remind",remind_by:"mobile",username:mobile,country_code:isd_code},function(data,status){if(status=='success'){var dta=$.trim(data);var ar=dta.split('^^');dta=ar[0];var code=ar[1];if(dta=='OTP sent successfully'){if(document.domain.indexOf('exportersindia.com')==-1){alert(code)}
if(mode&&mode=='forget_your_mobile'){$('#forgotID2').hide();$('#change_em_otp').hide();otpTimer()}else{$("#loginPassword").hide()}
$('.request_otp_text').html(' +91-'+mobile);$("#loginWOTP").show();$("#change_function_name").attr("onclick","send_otp_on_mobile();otpTimer();$('#re_send_otp').hide();$('#otp_time').show();");if(mode&&mode=='forget'){$("#otp-verify-nxt-btn").attr("onclick","request_otp_verify('forget');")}
$(".otp-code:first").focus();disabled_otp_verify_btn_func()}else{alert(data)}}else{alert(data);return!1}})}
function send_otp_on_email(mode=''){var forgot_email=$("#login_username").val();$("#otp_verified").val("");$("#sms_code").val("");$("#email_otp_verified").val("");$("#email_code").val("");$(".otp-code").val("");$(".request_otp_error").hide();url=$("#base_url").val()+"/login_ajax.php";$.post(url,{id:"remind",remind_by:"email",username:forgot_email,mode:mode},function(data,status){if(status=='success'){parse_data=$.parseJSON(data);if(parse_data.message=="success"){$("#loginPassword").hide();$('.request_otp_text').html(forgot_email);$("#loginWOTP").show();$("#change_function_name").attr("onclick","send_otp_on_email();otpTimer();$('#re_send_otp').hide();$('#otp_time').show();");$("#change_otp_call_fname").hide();if(mode&&mode=='forget'){$("#otp-verify-nxt-btn").attr("onclick","request_otp_verify('forget');")}
disabled_otp_verify_btn_func()}else{alert(parse_data.message)}}else{alert(data);return!1}})}
function request_otp_verify(mode=''){var logint;var mobile_login;var email_login;logint=$("#login_type").val();mobile_login=$("#popup_login").val().trim();email_login=$("#popup_login").val().trim();var member_type=$("#member_type").val();var ref_redirect_url=$("#ref_redirect_url").val();var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];var mobile_cont_code=$('#mobile_cont_code').val();var email_inputs=document.getElementsByClassName('otp-code'),v_code=[].map.call(email_inputs,function(input){return input.value}).join('');var mem_baseurl=$("#mem_baseurl").val();var url=$("#base_url").val()+"/login_ajax.php";if(v_code==''){$(".request_otp_error").html('Please enter OTP for verify');$(".request_otp_error").css("color","red");$(".request_otp_error").show();$(".otp-code:first").focus();return!1}
if(logint=='email'){$.post(url,{id:"validate_request_otp_email",email_code:v_code,login_email:email_login},function(data,status){if(status=="success"){parse_data=$.parseJSON(data);if($.trim(parse_data.message)=="Y"){if(mode&&mode=='forget'){$('#loginWOTP').hide();$('#changePassword').show();$('#new_pass').focus()}else{if(ref_redirect_url){location.replace(ref_redirect_url)}else{location.replace(mem_baseurl)}}}else{$(".request_otp_error").html(parse_data.message);$(".request_otp_error").show();$(".otp-code").val('');$(".otp-code:first").focus()}}else{alert(data);return!1}})}else if(logint=='mobile'){$.ajax({type:'POST',url:url,dataType:"html",data:{id:"validate_request_otp_mobile",your_mobile:mobile_login,sms_code:v_code,isd_code:isd_code,mobile_cont_code:mobile_cont_code},cache:!1,success:function(data){$("#otp_verified").val('');if($.trim(data)=='Invalid OTP'){$(".request_otp_error").html('Invalid OTP');$(".request_otp_error").css("color","red");$(".request_otp_error").show()}else if($.trim(data)=='step_verify_otp_done'){$("#otp_verified").val('Y');if(mode&&mode=='forget'){$('#loginWOTP').hide();$('#changePassword').show();$('#new_pass').focus()}else{if(ref_redirect_url){location.replace(ref_redirect_url)}else{location.replace(mem_baseurl)}}}else if($.trim(data)=='Entered OTP is expired'){$(".request_otp_error").html('Entered OTP is expired');$(".request_otp_error").css("color","red");$(".request_otp_error").show();$(".otp-code").val('');$(".otp-code:first").focus()}else{alert(data)}},xhrFields:{withCredentials:!0},crossDomain:!0,error:function(xhr,status){if(xhr.status==404){alert('Page Not Found.')}else if(xhr.status==401){alert('Authorization Required.')}}})}}
function update_password(){if($("#login_status").val()=="Y"&&$("#otp_verified").val()=="Y"){login_final()}else{var login_type=$('#login_type').val();var pass=$("#new_pass").val();var conf_pass=$("#conf_pass").val();var username=$("#login_username").val();var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];$(".new_pass_err").parent().removeClass('invalid');$(".conf_pass_err").parent().removeClass('invalid');if(pass==""){$("#new_pass").focus();$(".new_pass_err").parent().addClass('invalid');$(".new_pass_err").html('Please Enter New Password')}else if(pass!=""&&pass.trim().length<6){$("#new_pass").focus();$(".new_pass_err").parent().addClass('invalid');$(".new_pass_err").html('password should be at least 6 characters long')}else if(conf_pass==""){$("#conf_pass").focus();$(".conf_pass_err").parent().addClass('invalid');$(".conf_pass_err").html('Please Enter New Confirm Password')}else if(conf_pass!=""&&conf_pass.trim().length<6){$("#conf_pass").focus();$(".conf_pass_err").parent().addClass('invalid');$(".conf_pass_err").html('password should be at least 6 characters long')}else if(conf_pass!=pass){$("#conf_pass").focus();$(".conf_pass_err").parent().addClass('invalid');$(".conf_pass_err").html('Password Mismatch !!!!!!')}else{var otp_verified=$("#otp_verified").val();var url=$("#base_url").val()+"/login_ajax.php";$.post(url,{id:"update_password_new",passwd:pass,login_type:login_type,username:username,isd_code:isd_code},function(data,status){if(status=='success'){if($.trim(data)=="Y"){login_final_step2();$("#otp_verified").val("")}else{$("#new_pass").focus();$(".new_pass_err").parent().addClass('invalid');$(".new_pass_err").html($.trim(data))}}else{alert($.trim(data));return!1}})}}}
function change_username(){$("#login_box").show();$("#forgotPasswordMobile").hide();$("#forgotPasswordEmail").hide();$('#validateMobile1OTP').hide();$("#otp_verified").val('');$("#email_otp_verified").val('')}
function check_wl_ip_login(user_name,login_by){login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];return $.post(url,{id:"check_wl_ip_login",user_name:user_name,login_by:login_by,isd_code:isd_code},function(data,status){if(data==1){$("#check_wl_ip_login").val(1)}else{$("#check_wl_ip_login").val(0)}})}
function login_button_clicked(t){var uname;var pword;var obj_uname;var obj_pword;var login_type;var popup_login;var isd_code;var obj_mobile_login;var obj_email_login;var update_mobile_status;var update_mobile_otp_verified;var update_mobile;var primary_mobile_exist;var country_code;var lg_data_title;login_type=$('#login_type').val();popup_login=$("#popup_login").val().trim();login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];lg_data_title='Continue';if($(t).attr('data-title')){lg_data_title=$(t).attr('data-title')}
update_mobile_status=$("#update_mobile_status").val();update_mobile_otp_verified=$("#update_mobile_otp_verified").val();update_mobile=$("#update_mobile").val();primary_mobile_exist=$("#primary_mobile_exist").val();if(login_type=='mobile'&&popup_login==''){$("#popup_login").focus();if($('#popup_login').attr('required')){$('#loginWMobile ._error_mess').html('Enter valid mobile number to login');$('#popup_login').parent().parent().addClass('invalid')}
return!1}else if(login_type=='email'&&popup_login==''){$("#popup_login").focus();if($('#popup_login').attr('required')){$('#loginWMobile ._error_mess').html('Enter valid email to login');$('#popup_login').parent().parent().addClass('invalid')}
return!1}
if(login_type=='mobile'){if(isd_code==91&&isNaN(popup_login)==!1){if(popup_login.length<10||popup_login.length>10){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile ._error_mess").html("Mobile number should be 10 digits.");return!1}else{$("#popup_login").parent().parent().removeClass('invalid')}}
$.when(validate_user(popup_login)).then(function(){if($.trim($("#username_exists").val())=='Y'){if($('#password').length==0){$('#enter_pass_label').after('<input type="password" name="password" id="password" class="login-fc common-txt-cls loginPassword-field" placeholder="Enter password" required autocomplete ="current-password" maxlength="15">')}
pword=$("#password").val();if(pword){$("#password").parent().removeClass('invalid')}else{if(lg_data_title=='Continue'){$('#loginPasswordOtp').prev().hide()}else{$('#loginPassword').prev().hide()}
if(login_type=='email'){$('.pswd_title_text').html('Email ID');$('.pswd_title_val').html(popup_login)}else{$('.pswd_title_text').html('Mobile');$('.pswd_title_val').html(popup_login)}
if(lg_data_title=='Continue'){$('#loginPasswordOtp').show()}else{$('#loginPassword').show();$("#password").focus()}
return!1}
$.when(check_wl_ip_login(popup_login,login_type)).done(function(){ip_login=$("#check_wl_ip_login").val();$("#id_login_error_top").html('');if(ip_login==1){$("#loginWMobile .err_msg").html('Unauthorised login access');return!1}
login_by_mobile()})}})}else if(login_type=='email'){var regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;var mail_format=regex.test(popup_login);if(!mail_format){$("#popup_login").focus();$("#popup_login").parent().parent().addClass('invalid');$("#loginWMobile .err_msg").html("Enter valid email to login.");return!1}else{$("#popup_login").parent().parent().removeClass('invalid');var return_data_status="";return_data_status=validate_user(popup_login);$.when(validate_user(popup_login)).then(function(){if($.trim($("#username_exists").val())=='Y'){if($('#password').length==0){$('#enter_pass_label').after('<input type="password" name="password" id="password" class="login-fc common-txt-cls loginPassword-field" placeholder="Enter password" required autocomplete ="current-password" maxlength="15">')}
pword=$("#password").val();if(pword){$("#password").parent().removeClass('invalid')}else{if(lg_data_title=='Continue'){$('#loginPasswordOtp').prev().hide()}else{$('#loginPassword').prev().hide()}
if(login_type=='email'){$('.pswd_title_text').html('Email ID');$('.pswd_title_val').html(popup_login)}else{$('.pswd_title_text').html('Mobile');$('.pswd_title_val').html(popup_login)}
if(lg_data_title=='Continue'){$('#loginPasswordOtp').show()}else{$('#loginPassword').show();$("#password").focus()}
return!1}
$.when(check_wl_ip_login(popup_login,login_type)).done(function(){ip_login=$("#check_wl_ip_login").val();if(ip_login==1){$("#loginWMobile .err_msg").html('Unauthorised login access');return!1}
login_by_email()})}})}}}
function login_by_email(){url=$("#base_url").val()+"/login_ajax.php";var uname=$("#login_username").val();var password=$("#password").val();$.post(url,{id:"login_by_email",username:uname,password:password},function(data,status){if(status=='success'){parse_data=$.parseJSON(data);$("#login_status").val('');if($.trim(parse_data.logged_id)=='N'){$("#password").focus();$("#password").parent().addClass('invalid');$('#loginPassword ._error_mess').html('Incorrect Password')}else if($.trim(parse_data.logged_id)=='Y'){$("#password").parent().removeClass('invalid');$("#login_status").val('Y');login_final()}}else{alert(data)}})}
function login_by_mobile(){url=$("#base_url").val()+"/login_ajax.php";var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];var mobile=$("#popup_login").val();var password=$("#password").val();$.post(url,{id:"login_by_mobile",mobile:mobile,password:password,isd_code:isd_code},function(data,status){if(status=='success'){parse_data=$.parseJSON(data);$("#login_status").val('');if($.trim(parse_data.logged_id)=='B'){$("#password").focus();$("#password").parent().addClass('invalid');$('#loginPassword ._error_mess').html('Your account is blocked for today due to multiple failed attempts.')}else if($.trim(parse_data.logged_id)=='N'){$("#password").focus();$("#password").parent().addClass('invalid');$('#loginPassword ._error_mess').html('Incorrect Password')}else if($.trim(parse_data.logged_id)=='Y'){$("#password").parent().removeClass('invalid');$("#login_status").val('Y');login_final()}}else{alert(data)}})}
function verify_mobile(){if($("#login_status").val()=="Y"){request_otp()}}
function login_final(){var login_type=$("#login_type").val();var otp_verified=$("#otp_verified").val();var login_status=$("#login_status").val();var username=$("#popup_login").val();var member_type=$("#member_type").val();var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];if($("#otp_verified").val()=="Y"&&login_type=='mobile'){login_final_step2()}else{var url=$("#base_url").val()+"/login_ajax.php";if(login_type=='mobile'){$.ajax({type:'post',url:url,crossDomain:!0,xhrFields:{withCredentials:!0},data:{id:"check_mobile_verify_status",username:username,isd_code:isd_code},success:function(data,status){if(status=='success'){parse_data=$.parseJSON(data);if(member_type==1||member_type==0){$("#mobile_verify_status").val(parse_data.mobile_verify_status);$("#mobile_verify_days").val(parse_data.mobile_verify_days);var ndays=$("#mobile_verify_days").val();if(ndays=="Nan")ndays=0;if($("#mobile_verify_status").val()=="N"&&$("#mobile_verify_days").val()=="N"){verify_mobile()}else if($("#mobile_verify_status").val()=="Y"){if(ndays>90){verify_mobile()}else{login_final_step2()}}}else if(member_type>1){login_final_step2()}}else{alert(data);return!1}}})}else if(login_type=='email'){$.ajax({type:'post',url:url,crossDomain:!0,xhrFields:{withCredentials:!0},data:{id:"check_email_verify_status",username:username,isd_code:isd_code},success:function(data,status){if(status=='success'){parse_data=$.parseJSON(data);if(member_type==1||member_type==0){$("#email_verify_status").val(parse_data.email_verify_status);$("#email_verify_days").val(parse_data.email_verify_days);var ndays=$("#email_verify_days").val();if(ndays=="Nan")ndays=0;if($("#email_verify_status").val()=="N"&&$("#email_verify_days").val()=="N"){verify_mobile()}else if($("#email_verify_status").val()=="Y"){if(ndays>90){verify_mobile()}else{login_final_step_for_email()}}}else if(member_type>1){login_final_step_for_email()}}else{alert(data);return!1}}})}}}
function login_final_step2(){var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];var login_type=$("#login_type").val();var otp_verified=$("#otp_verified").val();var username=$("#popup_login").val();var pswd=$("#password").val();var url=$("#base_url").val()+"/login_ajax.php";var mem_baseurl=$("#mem_baseurl").val();var mobile_cont_code=$('#mobile_cont_code').val();var ref_redirect_url=$("#ref_redirect_url").val();$.ajax({type:'post',url:url,crossDomain:!0,xhrFields:{withCredentials:!0},data:{id:"login_final",login_type:login_type,isd_code:isd_code,username:username,otp_verified:otp_verified,pswd:pswd,mobile_cont_code:mobile_cont_code},success:function(data,status){if(status=='success'){if($.trim(data)=='Y'){if(ref_redirect_url){location.replace(ref_redirect_url)}else{location.replace(mem_baseurl)}}else{alert(data);return!1}}else{alert(data);return!1}}})}
function validate_mobile_update_user(uname){if(uname==''){$("#update_mobile").parent().addClass('invalid');$(".msg_update_mobile").html('Enter mobile number to verify');$("#update_mobile").focus();$('#update_mobile_validate').val('N');return!1}else{$("#update_mobile").parent().removeClass('invalid');$(".msg_update_mobile").html('')}
var update_mobile_country_code=$('#update_mobile_country_code').val();var str1=update_mobile_country_code.split("^");country_code=str1[0];isd_code=str1[1];if(isd_code==91){if(uname.length<10||uname.length>10){$("#update_mobile").parent().addClass('invalid');$("#update_mobile").focus();$(".msg_update_mobile").html("Mobile number should be 10 digits.");$('#update_mobile_validate').val('N');return!1}else{$(".msg_update_mobile").html("");$("#update_mobile").parent().removeClass('invalid');$('#update_mobile_validate').val('Y')}}else{if(uname.length<3||uname.length>16){$("#update_mobile").parent().addClass('invalid');$("#update_mobile").focus();$(".msg_update_mobile").html("Mobile number should be between 3 to 15 digits long");$('#update_mobile_validate').val('N');return!1}else{$(".msg_update_mobile").html("");$("#update_mobile").parent().removeClass('invalid');$('#update_mobile_validate').val('Y')}}}
function login_final_step_for_email(){var login_type=$("#login_type").val();var password=$("#password").val();var email_otp_verified=$("#otp_verified").val();var username=$("#login_username").val();var url=$("#base_url").val()+"/login_ajax.php";var mem_baseurl=$("#mem_baseurl").val();var ref_redirect_url=$("#ref_redirect_url").val();$.ajax({type:'post',url:url,crossDomain:!0,xhrFields:{withCredentials:!0},data:{id:"login_final_for_mail",login_type:login_type,email_otp_verified:email_otp_verified,username:username,password:password},success:function(data,status){if(status=='success'){if($.trim(data)=='Y'){if(ref_redirect_url){location.replace(ref_redirect_url)}else{location.replace(mem_baseurl)}}}else{alert(data);return!1}}})}
function mobileVerifyLoginMemberNew(member_id,mobile_phone,country_code,verify_form,redUrl){if(document.domain=='192.168.1.104'){var ajax_url='//192.168.1.104'}else if(document.domain.indexOf('betaei.in')>0){var ajax_url='//www.betaei.in'}else{var ajax_url='//www.exportersindia.com'}
var url=ajax_url+"/Functions/ei_mobile_verify_form_func.php";$(document).ready(function(){$.ajax({type:'POST',url:url,dataType:"html",data:{action_id:"ei_mobile_varify_first_form",verify_form:verify_form,mi:member_id,mobile_phone:mobile_phone,country_code:country_code},cache:!1,success:function(newHTML){$('#popup_ei').html(newHTML);$('#overlay_s').css({'display':'block','position':'fixed'})},xhrFields:{withCredentials:!0}})})}
function validate_user_email(uname2){var login_type;var uname=uname2.trim();login_type='email';if(login_type=='email'){var regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;var mail_format=regex.test(uname);if(uname.length==0){$("#forget_your_mob_email").focus();$("#forget_your_mob_email").parent().addClass('invalid');$("#forgotID .err_msg").html("Enter Email Id.");return!1}else if(!mail_format){$("#forget_your_mob_email").focus();$("#forget_your_mob_email").parent().addClass('invalid');$("#forgotID .err_msg").html("Enter valid email !!.");return!1}else{$("#forget_your_mob_email").parent().removeClass('invalid')}
url=$("#base_url").val()+"/login_ajax.php";$.ajax({type:"POST",url:url,async:!1,data:{id:"check_forget_your_mob_email_in_db",username:uname},success:function(data,status){if(status=='success'){parse_data=$.parseJSON(data);if($.trim(parse_data.username_exists)=='N'){$("#forgotID .err_msg").html("SORRY!! We could not find any account registered with this Email. Check the entered Email OR <a href='"+$("#base_url").val()+"/register-business-online?joinfree=signinpopupjoinnow&new_em="+uname+"' class='track_scr' data-uname='' data-title='Forget Your Mobile Register Now'>Register Now</a>.");$("#forget_your_mob_email").parent().addClass('invalid');return!1}else if($.trim(parse_data.username_exists)=='Y'){$("#login_type").val('email');$("#username_exists").val("Y");$("#member_type").val(parse_data.member_type);$("#login_username").val(uname);$("#forget_your_mob_email").parent().removeClass('invalid');return!0}}else{alert(data);return!1}}})}}
function forgot_your_mob_button_clicked(){var login_type='email';var forget_your_mob_email=$("#forget_your_mob_email").val().trim();var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");country_code=str[0];isd_code=str[1];if(forget_your_mob_email.length==0){$("#forget_your_mob_email").focus();if($('#forget_your_mob_email').attr('required')){$('#forgotID ._error_mess').html('Enter Email Id');$('#forget_your_mob_email').parent().addClass('invalid')}
return!1}else if(login_type=='email'&&forget_your_mob_email==''){$("#forget_your_mob_email").focus();if($('#forget_your_mob_email').attr('required')){$('#forgotID ._error_mess').html('Enter Valid Email Id !!!');$('#forget_your_mob_email').parent().addClass('invalid')}
return!1}
if(login_type=='email'){var regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;var mail_format=regex.test(forget_your_mob_email);if(!mail_format){$("#forget_your_mob_email").focus();$("#forget_your_mob_email").parent().addClass('invalid');$("#forgotID .err_msg").html("Enter Valid Email Id !! ");return!1}else{$("#forget_your_mob_email").parent().removeClass('invalid');var return_data_status="";return_data_status=validate_user_email(forget_your_mob_email);$.when(validate_user_email(forget_your_mob_email)).then(function(){if($.trim($("#username_exists").val())=='Y'){$.ajax({type:"POST",url:$("#base_url").val()+"/login_ajax.php",data:{id:"forgot_your_mob_step2",username:forget_your_mob_email},beforeSend:function(){$('#next_btn_forgot_mob').find('i').removeAttr('style')},success:function(data,status){if(status=='success'){$('#next_btn_forgot_mob').find('i').css('display','none');if(data){var gt_data=$.trim(data);var gt_data_arr=gt_data.split('^^');var gt_data_first=gt_data_arr[0];var gt_data_second=gt_data_arr[1];if(gt_data_first==2&&gt_data_second){$('#forgotID').hide();$('#forgotID2').show();$('#forgotID2_step').html(gt_data_second)}else if(gt_data_first==3&&gt_data_second.length==0){$('#forgotID').hide();$('#login_lk_send_email').html(forget_your_mob_email);$('#forgotID-thanks').show()}else if(gt_data_first==1&&gt_data_second.length==0){$('#forgotID2').hide();$('#forgot').show();$("#forget_your_mob_email").focus();$("#forget_your_mob_email").parent().addClass('invalid');$("#forgotID .err_msg").html("No Record Found !!!! ");return!1}else if(gt_data_first==4&&gt_data_second.length==0){$('#forgotID2').hide();$('#forgot').show();$("#forget_your_mob_email").focus();$("#forget_your_mob_email").parent().addClass('invalid');$("#forgotID .err_msg").html("No Record Found !!! ");return!1}}else{$('#forgotID2').hide();$('#forgot').show();$("#forget_your_mob_email").focus();$("#forget_your_mob_email").parent().addClass('invalid');$("#forgotID .err_msg").html("Invalid Email Id !! !!!!!!!!! ");return!1}}else{alert(data);return!1}}})}})}}}
function otpTimer(){var t=30;$("#time").text(t),$("#re_otp_bt").hide(),$("#change_em_otp").hide(),$("#otp_time").show();var e=setInterval((function(){if(--t<=-1)return clearInterval(e),$("#otp_time").hide(),void $("#re_otp_bt").show(),$("#change_em_otp").show();$("#time").text(t)}),1e3)}
function isNNumberKey(evt){var charCode=(evt.which)?evt.which:event.keyCode
if(charCode!=45&&charCode>31&&(charCode<48||charCode>57))
return!1;return!0}
function check_mob_otp_limit_func(mode=''){var mobile=$("#popup_login").val();var login_country_code=$('#login_country_code').val();var str=login_country_code.split("^");var country_code=str[0];var isd_code=str[1];url=$("#base_url").val()+"/login_ajax.php";if(country_code=='IN'){$.post(url,{id:"remind",remind_by:"mob_otp_limit_checker",username:mobile,country_code:isd_code},function(data,status){if(status=='success'){var dta=$.trim(data);if(dta==1){$('#re_otp_bt').hide();$('#re_send_otp').show();$('#otp_limit_over').html('')}else{$('#re_otp_bt').hide();$('#change_em_otp').show();$('#otp_time').hide();$('#otp_limit_over').html('OTP sent').css('font-weight','bold')}}else{console.log(data);return!1}})}else if(country_code!='IN'){$('#re_otp_bt').hide();$('#re_send_otp').show();$('#otp_limit_over').html('')}}
function disabled_otp_verify_btn_func(){}