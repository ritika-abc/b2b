!function(e){"use strict";e.fn.wlTokenInput=function(t){var n={tokenInputSelect:e(this),ajaxUrl:null,ismultiple:!1,maxToken:null,defaultInputPlaceHolder:"Choose Multiple States",highLightTime:1200},s=Object.assign(n,t),i=new function(t){var n=this;this.$self=t,this.$self.addClass("tokenInput-select-hide"),this.$self.prop("disabled",!0),this.$selfParent=this.$self.parent(),this.classConfig={classItems:{selfParentClass:"token-item",selfTempItemContainerClass:"token-item-temp",selfTokenItemSelectedList:"token-item-selected-list",selfTokenItemSelectedSpan:"token-item-drpdown-selected",selfTokenItemSelectedSpanDelIcon:"del",selfTokenItemSelectedHiddenInput:"token-item-drpdown-selected-hidden",selfTokenItemSelectedSpanMore:"token-item-drpdown-selected-more",selfTokenItemSelectedSpanSearch:"token-item-drpdown-search",selfTokenItemSelectedInputSearch:"token-item-search",selfTokenItemDrpDwnListContainer:"token-item-drpdwn-main",selfTokenItemDrpDwnListUl:"token-item-drpdwn-ul",selfTokenItemDrpDwnItem:"token-list-item"},getClassItemProp:function(e){return this.classItems[e]},setDot:function(e){return"."+this.getClassItemProp(e)},getDomselfParent:function(){return n.$selfParent},getDomTempItemContainer:function(){return this.getDomselfParent().find(this.setDot("selfTempItemContainerClass"))},getDomTokenItemSelectedList:function(){return this.getDomTempItemContainer().find(this.setDot("selfTokenItemSelectedList"))},getDomTokenItemSelectedSpan:function(){return this.getDomTokenItemSelectedList().find(this.setDot("selfTokenItemSelectedSpan"))},getDomTokenItemSelectedSpanDelIcon:function(){return this.getDomTokenItemSelectedSpan().find(this.setDot("selfTokenItemSelectedSpanDelIcon"))},getDomTokenItemSelectedHiddenInput:function(){return this.getDomTokenItemSelectedSpan().find(this.setDot("selfTokenItemSelectedHiddenInput"))},getDomTokenItemSelectedMoreSpan:function(){return this.getDomTokenItemSelectedList().find(this.setDot("selfTokenItemSelectedSpanMore"))},getDomTokenItemSelectedSearchSpan:function(){return this.getDomTokenItemSelectedList().find(this.setDot("selfTokenItemSelectedSpanSearch"))},getDomTokenItemSelectedSearchInput:function(){return this.getDomTokenItemSelectedSpan().find(this.setDot("selfTokenItemSelectedInputSearch"))},getDomTokenItemDrpDwnListContainer:function(){return this.getDomTempItemContainer().find(this.setDot("selfTokenItemDrpDwnListContainer"))},getDomTokenItemDrpDwnListUl:function(){return this.getDomTokenItemDrpDwnListContainer().find(this.setDot("selfTokenItemDrpDwnListUl"))},getDomTokenItemDrpDwnItem:function(){return this.getDomTokenItemDrpDwnListUl().find(this.setDot("selfTokenItemDrpDwnItem"))}},this.getInitElement={getElements:{tempItemContainer:e("<div>",{"class":this.classConfig.getClassItemProp("selfTempItemContainerClass")}),itemSelectedList:e("<div>",{"class":this.classConfig.getClassItemProp("selfTokenItemSelectedList")}),itemSelectedSpan:e("<span>",{"class":this.classConfig.getClassItemProp("selfTokenItemSelectedSpan")}),itemSelectedAnchor:e("<a>"),itemSelectedDelIcon:e("<i>",{"class":this.classConfig.getClassItemProp("selfTokenItemSelectedSpanDelIcon")}),itemSelectedHiddenInput:e("<input>",{"class":this.classConfig.getClassItemProp("selfTokenItemSelectedHiddenInput"),name:n.$self.attr("name"),value:"",type:"hidden"}),itemSelectedSpanMore:e("<span>",{"class":this.classConfig.getClassItemProp("selfTokenItemSelectedSpanMore"),text:"+1 More"}),itemSelectedSpanSearch:e("<span>",{"class":this.classConfig.getClassItemProp("selfTokenItemSelectedSpanSearch")}),itemSelectedSearchInput:e("<input>",{"class":this.classConfig.getClassItemProp("selfTokenItemSelectedInputSearch"),value:"",type:"text",placeholder:s.defaultInputPlaceHolder}),itemDrpDwnListContainer:e("<div>",{"class":this.classConfig.getClassItemProp("selfTokenItemDrpDwnListContainer")}),itemDrpDwnUl:e("<ul>",{"class":this.classConfig.getClassItemProp("selfTokenItemDrpDwnListUl")}),itemDrpDwnLi:e("<li>",{"class":this.classConfig.getClassItemProp("selfTokenItemDrpDwnItem"),"data-id":""})},getSelectedSpanList:function(t){var s=e("<document>"),i=this;return n.selectInput.isMultiple()?e.each(t,function(e,t){s.append(i.getSingleNewSpanList(t))}):s.html(i.getSingleNewSpanList(t)),s.prop("innerHTML")},getSingleNewSpanList:function(t){var n=this.getElements,s=n.itemSelectedSpan.prop("outerHTML");return s=e(s).append(n.itemSelectedAnchor.text(t.text)),s=e(s).append(n.itemSelectedDelIcon),s=e(s).append(n.itemSelectedHiddenInput.val(t.value)),s.prop("outerHTML")},getItemDrpDwnList:function(t){var n=this.getElements,s=e("<document>");return e.each(t,function(t,i){var l=n.itemDrpDwnLi.prop("outerHTML");l=e(l).attr("data-id",i.value),l=e(l).text(i.text),i.isSelected&&l.addClass("active"),s.append(l)}),s.html()},getSpanMoreWithText:function(e){return e>1?this.getElements.itemSelectedSpanMore.text("+"+(e-1)+" More ").prop("outerHTML"):""},getSpanInputHidden:function(){var e=this.getSpanMoreWithText(0);return e+=this.getElements.itemSelectedSearchInput.prop("outerHTML"),this.getElements.itemSelectedSpanSearch.append(e)},isItemSelectedByVaLue:function(e){return i.$selfParent.find("."+i.classConfig.getClassItemProp("selfTokenItemSelectedSpan")).find('input[value="'+e+'"]').length},initializeData:function(){var e=this.getElements.tempItemContainer.append(this.getElements.itemSelectedList).append(this.getElements.itemDrpDwnListContainer);return e.find(n.classConfig.setDot("selfTokenItemSelectedList")).append(this.getSpanInputHidden()),e.find(n.classConfig.setDot("selfTokenItemSelectedList")).find(n.classConfig.setDot("selfTokenItemSelectedSpanSearch")).before(this.getSelectedSpanList(n.selectInput.getSelected())),e.find(n.classConfig.setDot("selfTokenItemDrpDwnListContainer")).append(this.getElements.itemDrpDwnUl),e.find(n.classConfig.setDot("selfTokenItemDrpDwnListUl")).append(this.getItemDrpDwnList(n.selectInput.getAllOption())),n.$selfParent.append(e),n.attachEvents(),this.updateMoreData(),e.prop("outerHTML")},updateMoreData:function(){var e=n.listenEvents.getSelectedSpanData().length,t=n.$selfParent.find(n.classConfig.setDot("selfTokenItemSelectedList"));t.find(n.classConfig.setDot("selfTokenItemSelectedSpanMore")).remove(),t.find(n.classConfig.setDot("selfTokenItemSelectedSpanSearch")).before(this.getSpanMoreWithText(e))}},this.listenEvents={deleteItemOnClickDelIcon:function(){e(this).closest("span").find("input").val();i.selectInput.setUnSelectOptionByValue(e(this).closest("span").find("input").val()),i.getInitElement.updateMoreData()},addRemoveItemClickOnList:function(){var t={value:e(this).attr("data-id"),text:e(this).text()};if(i.getInitElement.isItemSelectedByVaLue(t.value)){var l=e(this);l.addClass("highlight"),setTimeout(function(){l.removeClass("highlight")},s.highLightTime)}else n.selectInput.isMultiple()||(n.$selfParent.find(n.classConfig.setDot("selfTokenItemDrpDwnListUl")).find(n.classConfig.setDot("selfTokenItemDrpDwnItem")).removeClass("active"),i.getInitElement.getElements.tempItemContainer.find(n.classConfig.setDot("selfTokenItemSelectedList")).find(n.classConfig.setDot("selfTokenItemSelectedSpan")).remove()),i.selectInput.setSelectOptionByValue(t);i.getInitElement.updateMoreData()},searchFilter:function(){null==s.ajaxUrl?n.listenEvents.normalSearching(e(this)):n.listenEvents.ajaxSearching(e(this))},getSelectedSpanData:function(){var t=[],s=n.classConfig.getDomTokenItemSelectedSpan();return s.each(function(n,s){t.push(e(s).find("input").val())}),t},setTempDrpDwnList:function(e){var t=n.getInitElement.getItemDrpDwnList(e);n.$selfParent.find(n.classConfig.setDot("selfTokenItemDrpDwnListUl")).empty().append(t)},setMainSelectList:function(t){var s="";e.each(t,function(e,t){s+='<option value="'+t.value+'" '+(t.isSelected?"selected":"")+">"+t.text+"</option>"}),n.$self.empty().append(s)},setSelectOption:function(t){var s=[],i=n.listenEvents.getSelectedSpanData();e.each(t,function(e,t){var n={value:t.id,text:t.title};-1!==i.indexOf(String(t.id))&&(n.isSelected=!0),s.push(n)}),n.listenEvents.setTempDrpDwnList(s),n.listenEvents.setMainSelectList(s)},ajaxSearching:function(t){var i=t.val().toUpperCase();e.ajax({url:s.ajaxUrl,type:"get",crossDomain:!0,data:{term:i},success:function(t){var s=e.parseJSON(t);n.listenEvents.setSelectOption(s)}})},normalSearching:function(t){var s,l,o;s=t.val().toUpperCase(),l=n.$selfParent.find("."+i.classConfig.getClassItemProp("selfTokenItemDrpDwnListContainer")).find("ul"),o=l.find("li"),o.each(function(t,n){e(n).text().toUpperCase().indexOf(s)>-1?e(n).show():e(n).hide()})}},this.attachEvents=function(){n.$selfParent.on("click","."+n.classConfig.getClassItemProp("selfTokenItemSelectedSpan")+" ."+n.classConfig.getClassItemProp("selfTokenItemSelectedSpanDelIcon"),this.listenEvents.deleteItemOnClickDelIcon),n.$selfParent.on("click","."+n.classConfig.getClassItemProp("selfTokenItemDrpDwnListUl")+" ."+n.classConfig.getClassItemProp("selfTokenItemDrpDwnItem"),this.listenEvents.addRemoveItemClickOnList),n.$selfParent.bind("focusin","."+n.classConfig.getClassItemProp("selfTokenItemSelectedInputSearch"),function(e){n.$selfParent.find("."+n.classConfig.getClassItemProp("selfTokenItemDrpDwnListContainer")).show(),e.stopPropagation()}),n.$selfParent.on("keyup","."+i.classConfig.getClassItemProp("selfTokenItemSelectedInputSearch"),this.listenEvents.searchFilter),e(document).on("click","body",function(t){0!==e(t.target).parents("."+i.classConfig.getClassItemProp("selfParentClass")).length&&e(t.target).parents("."+i.classConfig.getClassItemProp("selfParentClass")).is(n.$selfParent)?n.$selfParent.find(".token-item-selected-list").addClass("active"):(n.$selfParent.find("."+i.classConfig.getClassItemProp("selfTokenItemDrpDwnListContainer")).hide(),n.$selfParent.find(".token-item-selected-list").removeClass("active"))}),e(document).on("click",i.classConfig.setDot("selfTokenItemSelectedList"),function(){e(this).find(i.classConfig.setDot("selfTokenItemSelectedInputSearch")).focus()})},this.selectInput={isMultiple:function(){return n.$self.prop("multiple")},removeAllSelected:function(){n.$self.find("option:selected").prop("selected",!1)},getSelected:function(){var t,s=n.$self.find("option:selected");return this.isMultiple()?(t=[],s.each(function(){t.push({value:e(this).val(),text:e(this).text()})})):t={value:s.val(),text:s.text()},t},getAllOption:function(){var t=n.$self.find("option"),s=[];return t.each(function(){var t=e(this).prop("selected");s.push({value:e(this).val(),text:e(this).text(),isSelected:t})}),s},setSelectOptionByValue:function(e){n.$self.find('option[value="'+e.value+'"]').prop("selected",!0),n.$self.find('option[value="'+e.value+'"]').attr("selected"),n.$selfParent.find(n.classConfig.setDot("selfTokenItemDrpDwnListUl")).find(n.classConfig.setDot("selfTokenItemDrpDwnItem")+'[data-id="'+e.value+'"]').addClass("active");var t=i.getInitElement.getSingleNewSpanList(e);i.getInitElement.getElements.tempItemContainer.find(n.classConfig.setDot("selfTokenItemSelectedList")).find(n.classConfig.setDot("selfTokenItemSelectedSpanSearch")).before(t)},setUnSelectOptionByValue:function(e){n.$self.find('option[value="'+e+'"]').prop("selected",!1),n.$self.find('option[value="'+e+'"]').removeAttr("selected"),n.$selfParent.find(n.classConfig.setDot("selfTokenItemDrpDwnListUl")).find(n.classConfig.setDot("selfTokenItemDrpDwnItem")+'[data-id="'+e+'"]').removeClass("active"),n.$selfParent.find(n.classConfig.setDot("selfTokenItemSelectedList")).find(n.classConfig.setDot("selfTokenItemSelectedSpan")).find('input[value="'+e+'"]').closest("span").remove()}}}(s.tokenInputSelect);i.getInitElement.initializeData()}}(jQuery);